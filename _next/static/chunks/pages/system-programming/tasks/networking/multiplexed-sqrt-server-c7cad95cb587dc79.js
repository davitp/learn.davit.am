(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6705],{3141:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/system-programming/tasks/networking/multiplexed-sqrt-server",function(){return s(4755)}])},4755:function(e,n,s){"use strict";s.r(n),s.d(n,{useTOC:function(){return c}});var r=s(2676),i=s(3147),t=s(7983),l=s(6438),d=s(4947);function c(e){return[{value:"Requirements",id:"requirements",depth:3},{value:"Expected result",id:"expected-result",depth:3},{value:"Notes",id:"notes",depth:3},{value:"Bonus (Optional)",id:"bonus-optional",depth:3},{value:"Deliverables",id:"deliverables",depth:3}]}n.default=(0,i.c)(function(e){let{toc:n=c(e)}=e,s={code:"code",h1:"h1",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{children:"NET-2: Multiplexed Sqrt Server"}),"\n",(0,r.jsx)(s.h3,{id:n[0].id,children:n[0].value}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Write a C/C++ ",(0,r.jsx)(s.strong,{children:"TCP server"})," program that:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Creates a TCP socket and binds it to a specified port (default: ",(0,r.jsx)(s.strong,{children:"8080"}),")"]}),"\n",(0,r.jsx)(s.li,{children:"Listens for incoming client connections"}),"\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"epoll"})})," to handle ",(0,r.jsx)(s.strong,{children:"multiple simultaneous clients"})," in a single thread — no ",(0,r.jsx)(s.code,{children:"fork()"}),", no threads"]}),"\n",(0,r.jsxs)(s.li,{children:["All sockets (listening and client) must be set to ",(0,r.jsx)(s.strong,{children:"non-blocking"})," mode (",(0,r.jsx)(s.code,{children:"O_NONBLOCK"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["For each connected client:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Reads exactly ",(0,r.jsx)(s.strong,{children:"4 bytes"})," representing a signed 32-bit integer (",(0,r.jsx)(s.code,{children:"int32_t"}),") in ",(0,r.jsx)(s.strong,{children:"network byte order"})]}),"\n",(0,r.jsxs)(s.li,{children:["Computes ",(0,r.jsx)(s.code,{children:"f(x) = sqrt(abs(x))"})," and sends the result back as an ",(0,r.jsx)(s.strong,{children:"8-byte IEEE 754 double"})," in ",(0,r.jsx)(s.strong,{children:"network byte order"})]}),"\n",(0,r.jsx)(s.li,{children:"Handles the case where the client sends multiple requests over the same connection"}),"\n",(0,r.jsx)(s.li,{children:"Detects client disconnection and removes the descriptor from the epoll instance"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.li,{children:"Prints a log line when a client connects or disconnects, and for each request processed"}),"\n",(0,r.jsxs)(s.li,{children:["Runs indefinitely until terminated with ",(0,r.jsx)(s.strong,{children:"Ctrl+C"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Write a C/C++ ",(0,r.jsx)(s.strong,{children:"TCP client"})," program that:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Connects to the server at a specified IP address and port"}),"\n",(0,r.jsxs)(s.li,{children:["Reads an integer from ",(0,r.jsx)(s.code,{children:"stdin"}),", sends it to the server as a 4-byte network-order ",(0,r.jsx)(s.code,{children:"int32_t"})]}),"\n",(0,r.jsxs)(s.li,{children:["Receives the 8-byte ",(0,r.jsx)(s.code,{children:"double"})," response and prints the result"]}),"\n",(0,r.jsxs)(s.li,{children:["Repeats until ",(0,r.jsx)(s.code,{children:"EOF"})," (Ctrl+D) or the user types ",(0,r.jsx)(s.code,{children:"exit"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Both programs must use the ",(0,r.jsx)(s.strong,{children:"BSD socket API"})," and proper byte order conversion"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Handle all system call errors — check every return value"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:n[1].id,children:n[1].value}),"\n",(0,r.jsx)(s.p,{children:"The resulting applications should be able to build and execute from command line as follows:"}),"\n",(0,r.jsx)(s.pre,{icon:d.Fx,tabIndex:"0","data-language":"sh","data-word-wrap":"",children:(0,r.jsxs)(s.code,{children:[(0,r.jsx)(s.span,{children:(0,r.jsx)(s.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"make"})}),"\n",(0,r.jsxs)(s.span,{children:[(0,r.jsx)(s.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"./sqrt-server"}),(0,r.jsx)(s.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" 8080"})]})]})}),"\n",(0,r.jsx)(s.p,{children:"In separate terminals, run multiple clients simultaneously:"}),"\n",(0,r.jsx)(s.pre,{icon:d.Fx,tabIndex:"0","data-language":"sh","data-word-wrap":"",children:(0,r.jsx)(s.code,{children:(0,r.jsxs)(s.span,{children:[(0,r.jsx)(s.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"./sqrt-client"}),(0,r.jsx)(s.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" 127.0.0.1"}),(0,r.jsx)(s.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" 8080"})]})})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Server terminal output:"})}),"\n",(0,r.jsx)(s.pre,{"data-word-wrap":"",children:(0,r.jsx)(s.code,{children:"[Server] Listening on port 8080 (epoll, non-blocking)\n[Server] Client connected: 127.0.0.1:54321 (fd=5)\n[Server] Client connected: 127.0.0.1:54322 (fd=6)\n[Server] fd=5 recv: -16 -> sqrt(abs(-16)) = 4.000000\n[Server] fd=6 recv: 225  -> sqrt(abs(225))  = 15.000000\n[Server] fd=5 recv: 0    -> sqrt(abs(0))    = 0.000000\n[Server] Client disconnected: fd=5\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Client terminal output:"})}),"\n",(0,r.jsx)(s.pre,{"data-word-wrap":"",children:(0,r.jsx)(s.code,{children:"[Client] Connected to 127.0.0.1:8080\n> -16\n[Server]: sqrt(abs(-16)) = 4.000000\n> 225\n[Server]: sqrt(abs(225)) = 15.000000\n> exit\n[Client] Disconnecting...\n"})}),"\n",(0,r.jsx)(s.h3,{id:n[2].id,children:n[2].value}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Use ",(0,r.jsx)(s.code,{children:"epoll_create1(EPOLL_CLOEXEC)"})," to create the epoll instance"]}),"\n",(0,r.jsx)(s.li,{children:"Use level-triggered mode (default) — no need for edge-triggered for this task"}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"double"})," has no standard network byte order representation — use a byte-swap approach or send as raw bytes with a defined endianness (document your choice)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"sqrt"})," and ",(0,r.jsx)(s.code,{children:"fabs"})," are in ",(0,r.jsx)(s.code,{children:"<math.h>"})," / ",(0,r.jsx)(s.code,{children:"<cmath>"}),"; link with ",(0,r.jsx)(s.code,{children:"-lm"})," if needed"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:n[3].id,children:n[3].value}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Switch to ",(0,r.jsx)(s.strong,{children:"edge-triggered mode"})," (",(0,r.jsx)(s.code,{children:"EPOLLET"}),") and implement the full draining loop for reads"]}),"\n",(0,r.jsxs)(s.li,{children:["Support an ",(0,r.jsx)(s.strong,{children:"arbitrary number of requests per connection"})," with a per-client receive buffer to handle partial reads correctly"]}),"\n",(0,r.jsxs)(s.li,{children:["Add a ",(0,r.jsx)(s.strong,{children:"timeout"}),": disconnect clients that send no request within 30 seconds (use ",(0,r.jsx)(s.code,{children:"epoll_wait"})," timeout or ",(0,r.jsx)(s.code,{children:"timerfd"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["Report the ",(0,r.jsx)(s.strong,{children:"number of active connections"})," when receiving ",(0,r.jsx)(s.code,{children:"SIGUSR1"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:n[4].id,children:n[4].value}),"\n",(0,r.jsxs)(s.p,{children:["The final solution should contain a ",(0,r.jsx)(s.strong,{children:"Makefile"})," for building both programs. The Makefile should contain targets:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"all"})," — build both server and client"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"sqrt-server"})," — build only the server"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"sqrt-client"})," — build only the client"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"clean"})," — remove compiled binaries"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["It’s recommended to have the compiler and compiler flags declared as Makefile variables. Alternatively, ",(0,r.jsx)(s.strong,{children:"cmake"})," could also be used instead of make."]})]})},"/system-programming/tasks/networking/multiplexed-sqrt-server",{filePath:"pages/system-programming/tasks/networking/multiplexed-sqrt-server.mdx",timestamp:1771443918e3,pageMap:t.v,frontMatter:{description:"Build a high-performance multiplexed TCP server in C/C++ on Linux using epoll. The server accepts 4-byte signed integers from multiple simultaneous clients and responds with the square root of their absolute value, demonstrating non-blocking I/O and event-driven design.\n"},title:"NET-2: Multiplexed Sqrt Server"},"undefined"==typeof RemoteContent?c:RemoteContent.useTOC)}},function(e){e.O(0,[3560,2888,9774,179],function(){return e(e.s=3141)}),_N_E=e.O()}]);